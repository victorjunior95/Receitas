{"ast":null,"code":"var _jsxFileName = \"/home/cliente/Trybe/trybe-projects/sd-08-project-recipes-app/src/pages/ReceitasEmProgress.js\";\nimport React, { useEffect, useState, useContext } from 'react';\nimport { useLocation, useHistory } from 'react-router-dom';\nimport copy from 'clipboard-copy';\nimport shareIcon from \"../images/shareIcon.svg\";\nimport blackHeartIcon from \"../images/blackHeartIcon.svg\";\nimport whiteHeartIcon from \"../images/whiteHeartIcon.svg\";\nimport { fetchProductDetailsById } from '../services';\nimport LariContext from '../context/Context';\n\nconst handleInProgress = (idCurrentRecipe, isFood, setInProgress, setUseIngri) => {\n  if (localStorage.getItem('inProgressRecipes') === null) {\n    const recipesInProgress = {\n      cocktails: {},\n      meals: {}\n    };\n    localStorage.setItem('inProgressRecipes', JSON.stringify(recipesInProgress));\n    setUseIngri([]);\n  } else {\n    const storageProgessRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n    setInProgress(storageProgessRecipes);\n\n    if (isFood) {\n      const result = Object.keys(storageProgessRecipes.meals).indexOf(idCurrentRecipe);\n\n      if (result >= 0) {\n        console.log(result, 'ingrediente');\n        setUseIngri(storageProgessRecipes.meals[idCurrentRecipe]);\n      } else {\n        setUseIngri([]);\n      }\n    } else {\n      const result = Object.keys(storageProgessRecipes.cocktails).indexOf(idCurrentRecipe);\n\n      if (result >= 0) {\n        setUseIngri(storageProgessRecipes.cocktails[idCurrentRecipe]);\n      } else {\n        setUseIngri([]);\n      }\n    }\n  }\n};\n\nconst creatLocalObj = (usedIngridients, inProgress = {\n  meals: {},\n  cocktails: {}\n}, foodDetails = {\n  idMeal: ''\n}, isMeal) => {\n  let result = { ...inProgress\n  };\n\n  if (!isMeal) {\n    result = {\n      cocktails: { ...inProgress.cocktails,\n        [foodDetails.idDrink]: [...usedIngridients]\n      },\n      meals: { ...inProgress.meals\n      }\n    }; // result.cocktails[foodDetails.idDrink] = [...usedIngridients];\n  } else {\n    result = {\n      meals: { ...inProgress.meals,\n        [foodDetails.idMeal]: [...usedIngridients]\n      },\n      cocktails: { ...inProgress.cocktails\n      }\n    };\n  }\n\n  localStorage.setItem('inProgressRecipes', JSON.stringify(result));\n};\n\nfunction handleCheckBox(name, inProgress, foodDetail, ObjUsedIngri = {\n  obj: [],\n  fun: () => {},\n  isMeal: true\n}) {\n  console.log(name, inProgress, foodDetail);\n  const usedIngriObj = ObjUsedIngri.obj;\n  const FunUsedIngri = ObjUsedIngri.fun;\n  const isFood = ObjUsedIngri.isMeal;\n  let usedIngredients = [...usedIngriObj];\n  const index = usedIngredients.indexOf(name);\n\n  if (index >= 0) {\n    usedIngredients.splice(index, 1);\n  } else {\n    usedIngredients = [...usedIngredients, name];\n  }\n\n  FunUsedIngri(usedIngredients);\n  creatLocalObj(usedIngredients, inProgress, foodDetail, isFood);\n}\n\nconst Detalhes = () => {\n  const {\n    isFavorite,\n    setIsFavorite,\n    isMeal,\n    setIsMeal,\n    foodDetails,\n    setFoodDetails,\n    hidden,\n    setHidden,\n    usedIngri,\n    setUseIngri,\n    inProgress,\n    setInProgress,\n    handleIsFavorite\n  } = useContext(LariContext);\n  const [ingredients, setIngredients] = useState([]);\n  const [able, setAble] = useState(true);\n  const location = useLocation();\n  const history = useHistory();\n  useEffect(() => {\n    const verifyButnValidation = ingredient => {\n      // console.log(ingredient.length, usedIngri.length);\n      if (ingredient.length === usedIngri.length) {\n        // console.log('terminou');\n        setAble(false);\n      } else {\n        setAble(true); // console.log('ainda n terminou');\n      }\n    };\n\n    verifyButnValidation(ingredients); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [usedIngri.length]);\n  useEffect(() => {\n    const fav = JSON.parse(localStorage.getItem('favoriteRecipes')) || [];\n    const [,, id] = location.pathname.split('/');\n    setIsFavorite(fav.some(result => result.id === id));\n  }, []);\n  useEffect(() => {\n    const fetchData = async () => {\n      const [, type, id] = location.pathname.split('/');\n      const productType = {\n        comidas: 'meals',\n        bebidas: 'drinks'\n      };\n      const foodDetailRequest = await fetchProductDetailsById(id, type);\n      const foodDetail = foodDetailRequest[productType[type]][0];\n      const ingredientFilter = Object.keys(foodDetail).filter(key => key.includes('strIngredient') && foodDetail[key]);\n      setIsMeal(type === 'comidas');\n      setFoodDetails(foodDetail);\n      setIngredients(ingredientFilter);\n      handleInProgress(id, type === 'comidas', setInProgress, setUseIngri);\n    };\n\n    fetchData();\n  }, [location.pathname]);\n  if (!Object.keys(foodDetails).length) return /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 48\n    }\n  }, \"Loading...\");\n  const ObjUsedIngri = {\n    obj: usedIngri,\n    fun: setUseIngri,\n    isMeal\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    \"data-testid\": \"recipe-photo\",\n    src: isMeal ? foodDetails.strMealThumb : foodDetails.strDrinkThumb,\n    alt: foodDetails.strMeal,\n    width: \"300px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"h2\", {\n    \"data-testid\": \"recipe-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 7\n    }\n  }, isMeal ? foodDetails.strMeal : foodDetails.strDrink), /*#__PURE__*/React.createElement(\"h3\", {\n    \"data-testid\": \"recipe-category\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 7\n    }\n  }, isMeal ? foodDetails.strCategory : foodDetails.strAlcoholic), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    onClick: async () => {\n      const link = window.location.href.split('/in-progress')[0];\n      const one = 1000;\n      copy(link);\n      setHidden(true);\n      setTimeout(() => setHidden(false), one);\n    },\n    \"data-testid\": \"share-btn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: shareIcon,\n    alt: \"Share\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    hidden: !hidden,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 9\n    }\n  }, \"Link copiado!\")), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"image\",\n    \"data-testid\": \"favorite-btn\",\n    onClick: () => handleIsFavorite(!isFavorite),\n    src: isFavorite ? blackHeartIcon : whiteHeartIcon,\n    alt: \"Favorite\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 7\n    }\n  }), usedIngri[0] !== 'ElisaEumaGenia' && ingredients.map((ingredient, index) => {\n    const ingredientName = foodDetails[ingredient];\n    const ingMeasure = foodDetails[ingredient.replace('Ingredient', 'Measure')];\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: ingredient,\n      \"data-testid\": `${index}-ingredient-step`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 13\n      }\n    }, usedIngri.indexOf(ingredientName) >= 0 ? /*#__PURE__*/React.createElement(\"s\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 19\n      }\n    }, `${ingredientName} - ${ingMeasure}`) : `${ingredientName} - ${ingMeasure}`, /*#__PURE__*/React.createElement(\"input\", {\n      onChange: ({\n        target\n      }) => {\n        handleCheckBox(target.value, inProgress, foodDetails, ObjUsedIngri);\n      },\n      type: \"checkbox\",\n      value: `${ingredientName}`,\n      checked: usedIngri.indexOf(ingredientName) >= 0,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 15\n      }\n    }));\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    \"data-testid\": \"instructions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }\n  }, foodDetails.strInstructions), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    onClick: () => {\n      history.push('/receitas-feitas');\n    },\n    \"data-testid\": \"finish-recipe-btn\",\n    disabled: able,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 7\n    }\n  }, \"Finalizar Receita\"));\n};\n\nexport default Detalhes;","map":{"version":3,"sources":["/home/cliente/Trybe/trybe-projects/sd-08-project-recipes-app/src/pages/ReceitasEmProgress.js"],"names":["React","useEffect","useState","useContext","useLocation","useHistory","copy","fetchProductDetailsById","LariContext","handleInProgress","idCurrentRecipe","isFood","setInProgress","setUseIngri","localStorage","getItem","recipesInProgress","cocktails","meals","setItem","JSON","stringify","storageProgessRecipes","parse","result","Object","keys","indexOf","console","log","creatLocalObj","usedIngridients","inProgress","foodDetails","idMeal","isMeal","idDrink","handleCheckBox","name","foodDetail","ObjUsedIngri","obj","fun","usedIngriObj","FunUsedIngri","usedIngredients","index","splice","Detalhes","isFavorite","setIsFavorite","setIsMeal","setFoodDetails","hidden","setHidden","usedIngri","handleIsFavorite","ingredients","setIngredients","able","setAble","location","history","verifyButnValidation","ingredient","length","fav","id","pathname","split","some","fetchData","type","productType","comidas","bebidas","foodDetailRequest","ingredientFilter","filter","key","includes","strMealThumb","strDrinkThumb","strMeal","strDrink","strCategory","strAlcoholic","link","window","href","one","setTimeout","shareIcon","blackHeartIcon","whiteHeartIcon","map","ingredientName","ingMeasure","replace","target","value","strInstructions","push"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\nimport { useLocation, useHistory } from 'react-router-dom';\nimport copy from 'clipboard-copy';\nimport shareIcon from '../images/shareIcon.svg';\nimport blackHeartIcon from '../images/blackHeartIcon.svg';\nimport whiteHeartIcon from '../images/whiteHeartIcon.svg';\nimport { fetchProductDetailsById } from '../services';\nimport LariContext from '../context/Context';\n\nconst handleInProgress = (idCurrentRecipe, isFood, setInProgress, setUseIngri) => {\n  if (localStorage.getItem('inProgressRecipes') === null) {\n    const recipesInProgress = {\n      cocktails: {},\n      meals: {},\n    };\n    localStorage.setItem('inProgressRecipes', JSON.stringify(recipesInProgress));\n    setUseIngri([]);\n  } else {\n    const storageProgessRecipes = (\n      JSON.parse(localStorage.getItem('inProgressRecipes')));\n    setInProgress(storageProgessRecipes);\n    if (isFood) {\n      const result = Object.keys(storageProgessRecipes.meals).indexOf(idCurrentRecipe);\n      if (result >= 0) {\n        console.log(result, 'ingrediente');\n        setUseIngri(storageProgessRecipes.meals[idCurrentRecipe]);\n      } else {\n        setUseIngri([]);\n      }\n    } else {\n      const result = Object.keys(storageProgessRecipes.cocktails)\n        .indexOf(idCurrentRecipe);\n      if (result >= 0) {\n        setUseIngri(storageProgessRecipes.cocktails[idCurrentRecipe]);\n      } else {\n        setUseIngri([]);\n      }\n    }\n  }\n};\n\nconst creatLocalObj = (usedIngridients,\n  inProgress = { meals: {}, cocktails: {} }, foodDetails = { idMeal: '' }, isMeal) => {\n  let result = { ...inProgress };\n\n  if (!isMeal) {\n    result = {\n      cocktails: { ...inProgress.cocktails,\n        [foodDetails.idDrink]: [...usedIngridients] },\n      meals: { ...inProgress.meals },\n    };\n    // result.cocktails[foodDetails.idDrink] = [...usedIngridients];\n  } else {\n    result = {\n      meals: { ...inProgress.meals,\n        [foodDetails.idMeal]: [...usedIngridients] },\n      cocktails: { ...inProgress.cocktails },\n    };\n  }\n  localStorage.setItem('inProgressRecipes', JSON.stringify(result));\n};\n\nfunction handleCheckBox(name,\n  inProgress, foodDetail, ObjUsedIngri = { obj: [], fun: () => {}, isMeal: true }) {\n  console.log(name, inProgress, foodDetail);\n  const usedIngriObj = ObjUsedIngri.obj;\n  const FunUsedIngri = ObjUsedIngri.fun;\n  const isFood = ObjUsedIngri.isMeal;\n  let usedIngredients = [...usedIngriObj];\n  const index = usedIngredients.indexOf(name);\n  if (index >= 0) {\n    usedIngredients.splice(index, 1);\n  } else {\n    usedIngredients = [...usedIngredients, name];\n  }\n  FunUsedIngri(usedIngredients);\n  creatLocalObj(usedIngredients, inProgress, foodDetail, isFood);\n}\n\nconst Detalhes = () => {\n  const { isFavorite, setIsFavorite, isMeal, setIsMeal, foodDetails,\n    setFoodDetails, hidden, setHidden, usedIngri, setUseIngri,\n    inProgress, setInProgress, handleIsFavorite } = useContext(LariContext);\n  const [ingredients, setIngredients] = useState([]);\n  const [able, setAble] = useState(true);\n\n  const location = useLocation();\n  const history = useHistory();\n\n  useEffect(() => {\n    const verifyButnValidation = (ingredient) => {\n      // console.log(ingredient.length, usedIngri.length);\n      if (ingredient.length === usedIngri.length) {\n        // console.log('terminou');\n        setAble(false);\n      } else {\n        setAble(true);\n        // console.log('ainda n terminou');\n      }\n    };\n    verifyButnValidation(ingredients);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [usedIngri.length]);\n\n  useEffect(() => {\n    const fav = JSON.parse(localStorage.getItem('favoriteRecipes')) || [];\n    const [,, id] = location.pathname.split('/');\n    setIsFavorite(fav.some((result) => result.id === id));\n  }, []);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      const [, type, id] = location.pathname.split('/');\n      const productType = { comidas: 'meals', bebidas: 'drinks' };\n      const foodDetailRequest = await fetchProductDetailsById(id, type);\n      const foodDetail = foodDetailRequest[productType[type]][0];\n\n      const ingredientFilter = Object\n        .keys(foodDetail).filter(\n          (key) => key.includes('strIngredient') && foodDetail[key],\n        );\n\n      setIsMeal(type === 'comidas');\n      setFoodDetails(foodDetail);\n      setIngredients(ingredientFilter);\n\n      handleInProgress(id, type === 'comidas', setInProgress, setUseIngri);\n    };\n\n    fetchData();\n  }, [location.pathname]);\n\n  if (!Object.keys(foodDetails).length) return <h2>Loading...</h2>;\n  const ObjUsedIngri = { obj: usedIngri, fun: setUseIngri, isMeal };\n  return (\n    <div>\n      <img\n        data-testid=\"recipe-photo\"\n        src={ isMeal ? foodDetails.strMealThumb : foodDetails.strDrinkThumb }\n        alt={ foodDetails.strMeal }\n        width=\"300px\"\n      />\n      <h2 data-testid=\"recipe-title\">\n        {isMeal ? foodDetails.strMeal : foodDetails.strDrink}\n      </h2>\n      <h3 data-testid=\"recipe-category\">\n        { isMeal ? foodDetails.strCategory : foodDetails.strAlcoholic}\n      </h3>\n      <button\n        type=\"button\"\n        onClick={ async () => {\n          const link = window.location.href.split('/in-progress')[0];\n          const one = 1000;\n          copy(link);\n          setHidden(true);\n          setTimeout(() => setHidden(false), one);\n        } }\n        data-testid=\"share-btn\"\n      >\n        <img src={ shareIcon } alt=\"Share\" />\n        <span hidden={ !hidden }>Link copiado!</span>\n      </button>\n      <input\n        type=\"image\"\n        data-testid=\"favorite-btn\"\n        onClick={ () => handleIsFavorite(!isFavorite) }\n        src={ isFavorite ? blackHeartIcon : whiteHeartIcon }\n        alt=\"Favorite\"\n      />\n\n      { (usedIngri[0] !== 'ElisaEumaGenia')\n        && ingredients.map((ingredient, index) => {\n          const ingredientName = foodDetails[ingredient];\n          const ingMeasure = foodDetails[ingredient.replace('Ingredient', 'Measure')];\n\n          return (\n            <div key={ ingredient } data-testid={ `${index}-ingredient-step` }>\n              { usedIngri.indexOf(ingredientName) >= 0\n                ? <s>{`${ingredientName} - ${ingMeasure}`}</s>\n                : `${ingredientName} - ${ingMeasure}` }\n\n              <input\n                onChange={ ({ target }) => {\n                  handleCheckBox(target.value, inProgress,\n                    foodDetails, ObjUsedIngri);\n                } }\n                type=\"checkbox\"\n                value={ `${ingredientName}` }\n                checked={ usedIngri.indexOf(ingredientName) >= 0 }\n              />\n            </div>\n          );\n        })}\n      <p data-testid=\"instructions\">{foodDetails.strInstructions}</p>\n\n      <button\n        type=\"button\"\n        onClick={ () => { history.push('/receitas-feitas'); } }\n        data-testid=\"finish-recipe-btn\"\n        disabled={ able }\n      >\n        Finalizar Receita\n\n      </button>\n    </div>\n  );\n};\nexport default Detalhes;\n"]},"metadata":{},"sourceType":"module"}